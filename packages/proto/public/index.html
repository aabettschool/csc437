<head>
    <!--QUESTIONS
        Best practices of custom element in a fragment (include js module?)
        Possible to not use shadow dom and use a template (and vice versa)
        Best practices of importing styles and fonts into shadowDom
    -->
    <!--Barlow font-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/reset.css" />
    <link rel="stylesheet" href="/styles/tokens.css" />
    <link rel="stylesheet" href="/styles/page.css" />
    <script type="module" src="/js/living-space.js"></script>
</head>
<article class="page">
    <header>
        <h1 class="header">RoomNovel: A Novel Way To Find Roommates</h1>
        <span class="header">Profile
        <label>
            <input type="checkbox" autocomplete="off" onchange="toggleDarkMode(event)"/>
            Light Mode
        </label>
        </span>
    </header>
    <section class="logistics">
        <h3>Logistics</h3>
        <dl>
            <dt>Locations</dt>
            <dd>
                <p>Santa Cruz, CA</p>
                <p>San Luis Obispo, CA</p>
            </dd>
            <dt>Budget</dt>
            <dd>$$$ / month</dd>
            <dt>Max Roommates</dt>
            <dd>#</dd>
            <dt>Max Housemates</dt>
            <dd>#</dd>
            <dt>Cleanliness</dt>
            <dd>#/5</dd>
        </dl>
    </section>
    <section class="noise_preferences">
        <h3>Noise Preferences</h3>
        <table>
            <tr>
                <th>Day</th>
                <th>Start </th>
                <th>End </th>
                <th>Preference</th>
            </tr>
            <tr>
                <td>Every Day</td>
                <td>11:00PM</td>
                <td>8:00AM</td>
                <td>Quiet</td>
            </tr>
            <tr>
                <td>Monday</td>
                <td>8:00AM</td>
                <td>12:00PM</td>
                <td>Quiet</td>
            </tr>
        </table>
    </section>
    <section class="biography">
        <h3>Biography</h3>
        <h4>Age: ##</h4>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In faucibus enim efficitur dolor vulputate sodales. Donec in blandit enim, in consectetur justo. Aliquam sagittis quam ornare, condimentum ipsum ac, varius mi. Duis lacinia, eros a imperdiet consectetur, mauris quam hendrerit ipsum, id fermentum nisi enim ut neque. Aliquam erat volutpat. Nulla volutpat elit et ex aliquet dignissim. Donec eu lobortis libero, nec tincidunt velit. Praesent at imperdiet justo. Suspendisse potenti. Nam risus massa, semper et dolor eu, malesuada porttitor lorem. Integer finibus bibendum neque vitae cursus. Aliquam suscipit urna in dictum sodales. Ut semper semper augue sit amet consectetur. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.

            <br><br>Proin bibendum enim eros, eget vehicula est cursus sit amet. Mauris quis nisi at libero semper ullamcorper. Fusce egestas pulvinar turpis, sed lobortis purus rhoncus non. Integer pharetra dolor elit, nec ultrices orci mollis sed. Fusce dapibus ac turpis vel varius. Morbi metus orci, lobortis semper justo sit amet, faucibus luctus massa. Etiam sed tincidunt velit. Vivamus non turpis quis lacus egestas posuere. Morbi consequat risus orci, ullamcorper pharetra risus ullamcorper eu. Suspendisse vitae justo sem. Nam vel facilisis enim, vel dapibus felis. Maecenas vitae congue elit.</p>
    </section>
    <section class="endorsements">
        <h3>Endorsements</h3>
        <ul class="unbulleted_list">
            <li>
                <dl>
                    <dt>Endorsed By </dt>
                    <dd><a href="index.html">USER CLONE</a></dd>
                    <dt>Description</dt>
                    <dd>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin tincidunt nisi ut lacus ultricies vulputate. Suspendisse lacus purus, dapibus sed massa non, rhoncus euismod sem. Quisque ut odio interdum, laoreet elit eget, interdum diam. Aliquam erat volutpat. Curabitur nec iaculis sem, non tincidunt nibh. Vivamus placerat consequat tortor, in viverra neque. Suspendisse ac viverra risus. Nam volutpat eget nisl in pellentesque. Integer convallis congue venenatis. Curabitur congue, purus nec pulvinar tristique, nulla turpis sollicitudin nisi, et porta neque erat nec dui. Ut eu convallis tortor. Suspendisse potenti. Nunc accumsan risus justo, eu tincidunt purus gravida eget. Donec sed pretium diam.</dd>
                </dl>
            </li>
        </ul>
    </section>
    <section class="current_living_spaces">
        <h3>Current Living Spaces</h3>
        <div id = "a">
            <h2>Home A</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-template.html', event.target.closest('div'))">See More</button>
        </div>
        <div id = "b">
            <h2>Home B</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-template.html', event.target.closest('div'))">See More</button>
        </div>
        <div id = "c">
            <h2>Home c</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-template.html', event.target.closest('div'))">See More</button>
        </div>
    </section>
    <section class="pending_living_spaces">
        <h3>Pending Living Space Invitations</h3>
        <div id = "pending-a">
            <h2>Home A</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-invite-template.html', event.target.closest('div'))">See More</button>
        </div>
        <div id = "pending-b">
            <h2>Home B</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-invite-template.html', event.target.closest('div'))">See More</button>
        </div>

        <div id = "pending-c">
            <h2>Home c</h2>
            <button onclick="addFragment('http://127.0.0.1:8080/living-space-invite-template.html', event.target.closest('div'))">See More</button>
        </div>

        </section>
        <script>
            // Create a new DOMParser
            const parser = new DOMParser();

            const page = document.body;

            document.body.addEventListener(
                "dark-mode:toggle",
                (event) => {
                    const page = event.currentTarget;
                    const checked = event.detail.checked;
                    page.classList.toggle("light-mode", checked);
                }
            )

            function relayEvent(event, customEventString, detail){
                // Relay = object that dispatched event
                const relay = event.currentTarget;
                const customEvent = new CustomEvent(customEventString, {
                    bubbles: true,
                    detail,
                });

                relay.dispatchEvent(customEvent);
                event.stopPropagation();
            }

            function toggleDarkMode(event){
                relayEvent(event, 'dark-mode:toggle', {checked: event.target.checked});
            }


            function addFragment(href, wrapper){
                fetch(href).then((response) => {
                    if(response.status !== 200){
                        throw `Status: $(response.status}`;
                    }
                    return response.text();
                }).then((htmlString) => {
                    const doc = parser.parseFromString(htmlString, "text/html");
                    const article = doc.body.firstChild
                    wrapper.replaceChildren(article);
                }).catch((error) => {
                    const message = document.createTextNode(
                        `Failed to fetch ${href}: ${error}`
                    );
                    wrapper.append(message);
                });
            }
        </script>
</article>